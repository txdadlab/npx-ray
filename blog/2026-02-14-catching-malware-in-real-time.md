# Scanning Suspicious npm Packages in Real Time with npx-ray

**Published: February 14, 2026**

We built [npx-ray](https://github.com/txdadlab/npx-ray) to answer a simple question: *what's actually inside this npm package?* Today, within minutes of it being published to the npm registry, we flagged a package called `bt-bot-vpn-tele-manager` that exhibited multiple hallmarks of suspicious software. We then deobfuscated it to find out what it actually does. Here's the full story — what the scanner found, what we initially suspected, and what manual analysis revealed.

---

## The Discovery

npm's registry exposes an RSS feed of recently published packages at `https://registry.npmjs.org/-/rss`. We pulled the latest batch and ran npx-ray against anything that looked unusual. One package stood out immediately: **bt-bot-vpn-tele-manager@1.0.1**, published by a user called `bangtepllo` with no package description, no README, and no repository link.

```
npx npx-ray bt-bot-vpn-tele-manager --verbose
```

npx-ray returned a score of **50/100 (F) — DANGER**.

---

## What npx-ray Found

### 1. Heavy Obfuscation (Critical)

The main source file `src/index.js` is a single line — **24,733 characters** long. Instead of readable JavaScript, it looks like this:

```javascript
const _0x2046d5=_0x1afa;(function(_0x567107,_0x516613){const _0x45a303=_0x1afa,
_0x5c1834=_0x567107();while(!![]){try{const _0x358471=-parseInt(_0x45a303(0x15d))
/0x1+parseInt(_0x45a303(0xff))/0x2*(-par...
```

This is the unmistakable output of [javascript-obfuscator](https://obfuscator.io/), a tool that transforms readable code into deliberately unreadable code. The telltale signs:

- **`_0x` prefixed variables** — hexadecimal variable naming (`_0x2046d5`, `_0x1afa`, `_0x567107`)
- **`while(!![])` infinite loops** — obfuscated control flow (since `!![]` always evaluates to `true`)
- **Hex integer literals** — `parseInt(_0x45a303(0x15d))/0x1` instead of normal math
- **String array rotation** — a large array of 190 encoded strings that get rotated and accessed by index, hiding all the actual string values used in the code

Every single source file in the package (`index.js`, `database.js`, `add_server.js`, `create_server.js`, `delete_server.js`, `info_bot.js`, `menu.js`, `start.js`) uses this same obfuscation.

### 2. Embedded Credentials Pattern (Critical)

npx-ray's secrets scanner found what appeared to be credentials embedded in a URL within the obfuscated source. The evidence string shows `http****443@` — a pattern matching `user:password@host`.

### 3. IP Geolocation API Call (Info)

The IOC (Indicators of Compromise) scanner extracted a defanged URL from within the source:

```
hxxp[://]ip-api[.]com/json/
```

`ip-api.com/json/` is a free geolocation API that returns IP address, country, city, ISP, and approximate coordinates.

### 4. No Repository, No Provenance

- **No GitHub repository** linked
- **No package description**
- **No README** with usage instructions
- **Publisher email:** bangtepllo752@gmail.com (disposable-looking)
- **Published once** — version 1.0.1 with no prior versions

---

## Deobfuscation: What the Code Actually Does

After the initial scan, we deobfuscated the package by extracting the string array, running the rotation function in isolation (without executing any of the bot's actual code), and building a complete lookup table of all 190 hidden strings. This let us reconstruct the full behavior.

### Verdict: Not Malware — It's a VPN Reseller Bot

The deobfuscated code reveals that `bt-bot-vpn-tele-manager` is an **admin-only Telegram bot for managing VPN account provisioning**. The UI is entirely in Indonesian (Bahasa Indonesia), and the bot manages accounts for ZIVPN and other VPN protocols.

Here's what it actually does:

1. **Telegram bot** that reads `BOT_TOKEN` and `ADMIN_ID` from environment variables
2. **Admin-only access** — rejects non-admin users with "Akses Ditolak" (Access Denied)
3. **Manages VPN servers** in a local SQLite database (`{protocol}_server` tables)
4. **Creates VPN accounts** by calling HTTP APIs on VPN panel servers:
   - `http://{domain}:1000/create-{protocol}?username=...&password=...&exp=...&limitip=...&quota=...`
   - `http://{domain}:1000/create-zivpn?username=...&password=...&exp=...`
5. **Supported VPN protocols**: SSH, VLESS, ZIVPN (with TLS, gRPC, and non-TLS variants)
6. **IP geolocation**: `http://ip-api.com/json/{server_domain}` — queries the server's location to display to the admin, **not** to fingerprint victims

### The "Embedded Credential" Explained

The `http****443@` that the secrets scanner flagged is actually from **SSH connection string display templates**:

- `:443@` — part of the format `{user}:{pass}:443@{domain}` (WebSocket TLS connection string)
- `:80@` — part of the format `{user}:{pass}:80@{domain}` (WebSocket non-TLS connection string)

These are **display templates** showing the VPN user how to connect to the server — the `user:pass@host` pattern triggered the "credentials in URL" regex. There are no hardcoded credentials in the package.

### Why Was It Obfuscated?

The obfuscation is almost certainly to protect the author's commercial product from being copied — this appears to be a paid VPN reseller management tool in the Indonesian VPN market. The ZIVPN references and Indonesian-language UI ("Masukan Username", "Masa Aktif", "Akun Berhasil Dibuat") are consistent with the Indonesian VPN reseller ecosystem.

---

## Lessons Learned

### 1. Static Analysis Has Limits — And That's OK

npx-ray correctly flagged every suspicious signal: the obfuscation was real, the credential-like pattern was real, the geolocation API was real, and the missing metadata was real. Without deobfuscation, these signals *should* make you cautious. A 50/F score means "don't install this without investigation" — which is exactly the right advice.

### 2. Obfuscation Is Still a Red Flag

Even though this package turned out to be non-malicious, obfuscating npm package source code is bad practice. Users cannot review what they're installing. The author could have published readable source code with the same functionality and received a much higher trust score. Obfuscation on npm should always be treated with suspicion, even if the underlying code is benign.

### 3. Deobfuscation Changes the Picture

The initial scan told us *something is hidden*. Deobfuscation told us *what's hidden*. For any package that scores poorly due to obfuscation, the next step should always be manual analysis — either through deobfuscation tools or sandbox execution.

### 4. False Positives Are Part of the Process

The secrets scanner flagging SSH connection string templates as "embedded credentials" is a false positive. This is expected — pattern-based scanning will always have edge cases where legitimate patterns match malicious signatures. The scanner's job is to surface everything suspicious and let the human analyst make the final call.

---

## The Full Report

Here's the raw npx-ray output:

```
Package: bt-bot-vpn-tele-manager@1.0.1
Publisher: bangtepllo
Published: 2026-02-14T15:12:58.458Z
License: MIT
Files: 10
Size: 43.8 KB

Risk Score: 50/100 (F)

Scan Results

  ⚠️ Static: Found 1 warning pattern(s) across 8 files
    WARNING axios — HTTP client src/index.js:1

  ❌ Obfuscation: Obfuscation indicators: 1 critical, 2 warning, 8 info
    CRITICAL Large string array (>50 elements) — common obfuscation pattern
    WARNING Hex-encoded string sequences detected (src/index.js, src/lib/database.js)
    INFO Very long lines (up to 24,733 chars) across 7 files

  ❌ Secrets: Secrets found: 1 critical
    CRITICAL Embedded credentials in URL src/index.js:1

  ✅ Ioc: 1 URL(s) extracted (defanged)
    INFO URL: hxxp[://]ip-api[.]com/json/

  ⚠️ No GitHub repository found

  Verdict: DANGER — Manual review strongly recommended
```

The full machine-readable JSON report is [available on GitHub](https://github.com/txdadlab/npx-ray/blob/main/bt-bot-vpn-tele-manager-report.json).

---

## Deobfuscated String Table (Excerpt)

After running the string array rotation, we recovered all 190 hidden strings. Key entries:

| Index | Resolved String | Purpose |
|---|---|---|
| `0x157` | `http://` | URL prefix for API calls |
| `0x15b` | `http://ip-api.com/json/` | Server geolocation lookup |
| `0x155` | `:1000/create-zivpn?username=` | ZIVPN account creation endpoint |
| `0x140` | `:1000/create-` | Generic VPN account creation |
| `0x128` | `:443@` | WS TLS connection string template |
| `0x147` | `:80@` | WS non-TLS connection string template |
| `0x19d` | `BOT_TOKEN` | Telegram bot token env var |
| `0x18a` | `env` | `process.env` access |
| `0x152` | `SELECT * FROM ` | Database query prefix |
| `0x160` | `INSERT INTO ` | Database insert prefix |
| `0x13c` | `DELETE FROM ` | Database delete prefix |
| `0x144` | `ssh` | SSH protocol |
| `0x1b3` | `vless` | VLESS protocol |
| `0x167` | `zivpn` | ZIVPN protocol |

---

## Timeline

| Time | Event |
|---|---|
| 15:12:58 UTC | `bt-bot-vpn-tele-manager@1.0.1` published to npm by `bangtepllo` |
| ~15:13 UTC | Package appears in npm RSS feed |
| ~15:15 UTC | npx-ray scan completed — **50/F DANGER** |
| Later same day | Manual deobfuscation reveals non-malicious VPN management bot |

From publication to detection: **under 3 minutes.** Deobfuscation and full analysis completed the same day.

---

## How to Protect Yourself

1. **Scan before you install.** Run `npx npx-ray <package>` before adding any new dependency. It downloads the tarball, runs 8 security scanners, and gives you a risk score — all without executing a single line of the package's code.

2. **Watch for obfuscation.** There is almost never a legitimate reason for an npm package to ship obfuscated source code. If you can't read it, you can't trust it — even if the underlying code turns out to be benign.

3. **Check the metadata.** No description, no repository, no README, single maintainer with a disposable email — these are all red flags that warrant manual investigation.

4. **Follow up on flags.** A low score from npx-ray means "investigate further," not necessarily "this is malware." Deobfuscation and sandbox analysis are the next steps for obfuscated packages.

5. **Monitor new dependencies.** Use npx-ray's `--json` flag in CI/CD pipelines to automatically scan new dependencies before they enter your project.

---

## Try It Yourself

```bash
npx npx-ray <any-package-name>
```

No install required. No account required. Runs entirely locally. [Source code on GitHub.](https://github.com/txdadlab/npx-ray)

---

*The JSON evidence report is [published on GitHub](https://github.com/txdadlab/npx-ray/blob/main/bt-bot-vpn-tele-manager-report.json). The deobfuscation was performed by extracting and evaluating only the string array rotation function — no code from the package was executed.*
