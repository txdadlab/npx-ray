# Catching npm Malware in Real Time with npx-ray

**Published: February 14, 2026**

We built [npx-ray](https://github.com/txdadlab/npx-ray) to answer a simple question: *what's actually inside this npm package?* Today, within minutes of it being published to the npm registry, we caught a package called `bt-bot-vpn-tele-manager` exhibiting every hallmark of malicious software. Here's what we found and how we found it.

---

## The Discovery

npm's registry exposes an RSS feed of recently published packages at `https://registry.npmjs.org/-/rss`. We pulled the latest batch and ran npx-ray against anything that looked unusual. One package stood out immediately: **bt-bot-vpn-tele-manager@1.0.1**, published by a user called `bangtepllo` with no package description, no README, and no repository link.

```
npx npx-ray bt-bot-vpn-tele-manager --verbose
```

npx-ray returned a score of **50/100 (F) — DANGER**.

---

## What npx-ray Found

### 1. Heavy Obfuscation (Critical)

The main source file `src/index.js` is a single line — **24,733 characters** long. Instead of readable JavaScript, it looks like this:

```javascript
const _0x2046d5=_0x1afa;(function(_0x567107,_0x516613){const _0x45a303=_0x1afa,
_0x5c1834=_0x567107();while(!![]){try{const _0x358471=-parseInt(_0x45a303(0x15d))
/0x1+parseInt(_0x45a303(0xff))/0x2*(-par...
```

This is the unmistakable output of [javascript-obfuscator](https://obfuscator.io/), a tool that transforms readable code into deliberately unreadable code. The telltale signs:

- **`_0x` prefixed variables** — hexadecimal variable naming (`_0x2046d5`, `_0x1afa`, `_0x567107`)
- **`while(!![])` infinite loops** — obfuscated control flow (since `!![]` always evaluates to `true`)
- **Hex integer literals** — `parseInt(_0x45a303(0x15d))/0x1` instead of normal math
- **String array rotation** — a large array of 50+ encoded strings that get rotated and accessed by index, hiding all the actual string values used in the code

Every single source file in the package (`index.js`, `database.js`, `add_server.js`, `create_server.js`, `delete_server.js`, `info_bot.js`, `menu.js`, `start.js`) uses this same obfuscation. There is no legitimate reason to obfuscate the source code of an npm package that users are expected to install and trust.

### 2. Embedded Credentials (Critical)

npx-ray's secrets scanner found credentials embedded directly in a URL within the obfuscated source. The evidence string shows `http****443@` — a URL containing a username and password. This is commonly how malware hardcodes its command-and-control server credentials or exfiltration endpoints.

### 3. IP Geolocation Fingerprinting (Info)

The IOC (Indicators of Compromise) scanner extracted a defanged URL from within the source:

```
hxxp[://]ip-api[.]com/json/
```

`ip-api.com/json/` is a free geolocation API that returns the caller's IP address, country, city, ISP, and approximate coordinates. Legitimate applications rarely need this. Malware uses it to:

- **Fingerprint victims** — know where the infected machine is located
- **Geofence attacks** — only activate the payload in specific countries
- **Evade analysis** — detect if they're running in a security researcher's sandbox

### 4. Suspicious Dependency Combination

The package declares six dependencies:

| Dependency | Purpose | Suspicion Level |
|---|---|---|
| **telegraf** | Telegram Bot API framework | Telegram is a common C2 channel for malware |
| **axios** | HTTP client | Network requests (to ip-api.com and elsewhere) |
| **sqlite3** / **sqlite** | Local database | Storing stolen data before exfiltration |
| **dotenv** | Environment variable loading | Reading config (possibly stolen credentials) |
| **nodemon** | Auto-restart on file changes | Persistence mechanism |

The combination of a **Telegram bot framework** + **HTTP client** + **local database** + **IP geolocation** is a well-known pattern for credential-stealing bots that exfiltrate data through Telegram channels.

### 5. No Repository, No Provenance

- **No GitHub repository** linked
- **No package description**
- **No README** with usage instructions
- **Publisher email:** bangtepllo752@gmail.com (disposable-looking)
- **Published once** — version 1.0.1 with no prior versions

Legitimate packages almost always have a repository link, a description, and documentation. The absence of all three is a red flag.

---

## The Full Report

Here's the raw npx-ray output:

```
Package: bt-bot-vpn-tele-manager@1.0.1
Publisher: bangtepllo
Published: 2026-02-14T15:12:58.458Z
License: MIT
Files: 10
Size: 43.8 KB

Risk Score: 50/100 (F)

Scan Results

  ⚠️ Static: Found 1 warning pattern(s) across 8 files
    WARNING axios — HTTP client src/index.js:1

  ❌ Obfuscation: Obfuscation indicators: 1 critical, 2 warning, 8 info
    CRITICAL Large string array (>50 elements) — common obfuscation pattern
    WARNING Hex-encoded string sequences detected (src/index.js, src/lib/database.js)
    INFO Very long lines (up to 24,733 chars) across 7 files

  ❌ Secrets: Secrets found: 1 critical
    CRITICAL Embedded credentials in URL src/index.js:1

  ✅ Ioc: 1 URL(s) extracted (defanged)
    INFO URL: hxxp[://]ip-api[.]com/json/

  ⚠️ No GitHub repository found

  Verdict: DANGER — Manual review strongly recommended
```

The full machine-readable JSON report is [available on GitHub](https://github.com/txdadlab/npx-ray/blob/main/bt-bot-vpn-tele-manager-report.json).

---

## What We Couldn't See

It's important to be transparent about the limits of static analysis. npx-ray detected that the code is obfuscated and found the indicators listed above, but because the string values are hidden behind the string array rotation, we **cannot** see:

- The actual Telegram bot token or channel ID used for C2
- The full URL with embedded credentials (only a partial match)
- What data the bot collects and exfiltrates
- Whether there are additional encoded payloads inside the string array

To fully deobfuscate this package would require either running the code in a sandbox or using a JavaScript AST deobfuscator to unwind the string array rotation. npx-ray is a static scanner by design — it tells you something is hidden and gives you enough evidence to decide not to install.

---

## Timeline

| Time | Event |
|---|---|
| 15:12:58 UTC | `bt-bot-vpn-tele-manager@1.0.1` published to npm by `bangtepllo` |
| ~15:13 UTC | Package appears in npm RSS feed |
| ~15:15 UTC | npx-ray scan completed — **50/F DANGER** |
| ~15:20 UTC | Reported to npm security team |

From publication to detection: **under 3 minutes.**

---

## How to Protect Yourself

1. **Scan before you install.** Run `npx npx-ray <package>` before adding any new dependency. It downloads the tarball, runs 8 security scanners, and gives you a risk score — all without executing a single line of the package's code.

2. **Watch for obfuscation.** There is almost never a legitimate reason for an npm package to ship obfuscated source code. If you can't read it, you can't trust it.

3. **Check the metadata.** No description, no repository, no README, single maintainer with a disposable email — these are all red flags.

4. **Monitor new dependencies.** Use npx-ray's `--json` flag in CI/CD pipelines to automatically scan new dependencies before they enter your project.

5. **Report what you find.** If npx-ray flags something suspicious, report it at [npmjs.com/support](https://www.npmjs.com/support?inquire=abuse). npm's security team reviews reports and removes confirmed malware.

---

## Try It Yourself

```bash
npx npx-ray <any-package-name>
```

No install required. No account required. Runs entirely locally. [Source code on GitHub.](https://github.com/txdadlab/npx-ray)

---

*This package was reported to npm's security team on February 14, 2026. The JSON evidence report is [published on GitHub](https://github.com/txdadlab/npx-ray/blob/main/bt-bot-vpn-tele-manager-report.json).*
